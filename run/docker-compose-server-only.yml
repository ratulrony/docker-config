version: '2'

services:
    redis:
        image: redis:latest
        volumes:
        - redis_data:/data
        command: "redis-server --appendonly yes"

    mongo:
        image: mongo:latest
        volumes:
        - mongo_data:/data/db
        command: "--smallfiles"

    web:
        image: thumbsniper/web:latest
        volumes:
        - web_thumbnails:/opt/thumbsniper/web_images/thumbnails
#        - /data/docker/thumbsniper/config/backend-config.inc.php:/opt/thumbsniper/config/backend-config.inc.php
#        - /data/docker/thumbsniper/config/panel-config.inc.php:/opt/thumbsniper/config/panel-config.inc.php


        links:
        - mongo
        - redis
        ports:
        - "80:80"
        networks:
            default:
                aliases:
                    - api.example.com
                    - img.example.com

volumes:
    redis_data:
    mongo_data:
    web_thumbnails:
